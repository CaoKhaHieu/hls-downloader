/*! For license information please see hls-downloader.js.LICENSE.txt */
(()=>{var t={216:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_VIDEOS_DOWNLOADING=void 0,e.MAX_VIDEOS_DOWNLOADING=1},425:(t,e,i)=>{"use strict";function n(t,e){return function(){return t.apply(e,arguments)}}const{toString:r}=Object.prototype,{getPrototypeOf:s}=Object,o=(a=Object.create(null),t=>{const e=r.call(t);return a[e]||(a[e]=e.slice(8,-1).toLowerCase())});var a;const u=t=>(t=t.toLowerCase(),e=>o(e)===t),c=t=>e=>typeof e===t,{isArray:l}=Array,d=c("undefined"),f=u("ArrayBuffer"),h=c("string"),p=c("function"),g=c("number"),m=t=>null!==t&&"object"==typeof t,b=t=>{if("object"!==o(t))return!1;const e=s(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Symbol.toStringTag in t||Symbol.iterator in t)},E=u("Date"),y=u("File"),T=u("Blob"),w=u("FileList"),R=u("URLSearchParams"),[A,D,O,S]=["ReadableStream","Request","Response","Headers"].map(u);function v(t,e,{allOwnKeys:i=!1}={}){if(null==t)return;let n,r;if("object"!=typeof t&&(t=[t]),l(t))for(n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else{const r=i?Object.getOwnPropertyNames(t):Object.keys(t),s=r.length;let o;for(n=0;n<s;n++)o=r[n],e.call(null,t[o],o,t)}}function I(t,e){e=e.toLowerCase();const i=Object.keys(t);let n,r=i.length;for(;r-- >0;)if(n=i[r],e===n.toLowerCase())return n;return null}const N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:i.g,P=t=>!d(t)&&t!==N,C=(x="undefined"!=typeof Uint8Array&&s(Uint8Array),t=>x&&t instanceof x);var x;const L=u("HTMLFormElement"),B=(({hasOwnProperty:t})=>(e,i)=>t.call(e,i))(Object.prototype),M=u("RegExp"),U=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t),n={};v(i,((i,r)=>{let s;!1!==(s=e(i,r,t))&&(n[r]=s||i)})),Object.defineProperties(t,n)},X="abcdefghijklmnopqrstuvwxyz",F="0123456789",j={DIGIT:F,ALPHA:X,ALPHA_DIGIT:X+X.toUpperCase()+F},_=u("AsyncFunction"),V=(k="function"==typeof setImmediate,$=p(N.postMessage),k?setImmediate:$?(q=`axios@${Math.random()}`,G=[],N.addEventListener("message",(({source:t,data:e})=>{t===N&&e===q&&G.length&&G.shift()()}),!1),t=>{G.push(t),N.postMessage(q,"*")}):t=>setTimeout(t));var k,$,q,G;const H="undefined"!=typeof queueMicrotask?queueMicrotask.bind(N):"undefined"!=typeof process&&process.nextTick||V;var K={isArray:l,isArrayBuffer:f,isBuffer:function(t){return null!==t&&!d(t)&&null!==t.constructor&&!d(t.constructor)&&p(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||p(t.append)&&("formdata"===(e=o(t))||"object"===e&&p(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&f(t.buffer),e},isString:h,isNumber:g,isBoolean:t=>!0===t||!1===t,isObject:m,isPlainObject:b,isReadableStream:A,isRequest:D,isResponse:O,isHeaders:S,isUndefined:d,isDate:E,isFile:y,isBlob:T,isRegExp:M,isFunction:p,isStream:t=>m(t)&&p(t.pipe),isURLSearchParams:R,isTypedArray:C,isFileList:w,forEach:v,merge:function t(){const{caseless:e}=P(this)&&this||{},i={},n=(n,r)=>{const s=e&&I(i,r)||r;b(i[s])&&b(n)?i[s]=t(i[s],n):b(n)?i[s]=t({},n):l(n)?i[s]=n.slice():i[s]=n};for(let t=0,e=arguments.length;t<e;t++)arguments[t]&&v(arguments[t],n);return i},extend:(t,e,i,{allOwnKeys:r}={})=>(v(e,((e,r)=>{i&&p(e)?t[r]=n(e,i):t[r]=e}),{allOwnKeys:r}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,i,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),i&&Object.assign(t.prototype,i)},toFlatObject:(t,e,i,n)=>{let r,o,a;const u={};if(e=e||{},null==t)return e;do{for(r=Object.getOwnPropertyNames(t),o=r.length;o-- >0;)a=r[o],n&&!n(a,t,e)||u[a]||(e[a]=t[a],u[a]=!0);t=!1!==i&&s(t)}while(t&&(!i||i(t,e))&&t!==Object.prototype);return e},kindOf:o,kindOfTest:u,endsWith:(t,e,i)=>{t=String(t),(void 0===i||i>t.length)&&(i=t.length),i-=e.length;const n=t.indexOf(e,i);return-1!==n&&n===i},toArray:t=>{if(!t)return null;if(l(t))return t;let e=t.length;if(!g(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=t[e];return i},forEachEntry:(t,e)=>{const i=(t&&t[Symbol.iterator]).call(t);let n;for(;(n=i.next())&&!n.done;){const i=n.value;e.call(t,i[0],i[1])}},matchAll:(t,e)=>{let i;const n=[];for(;null!==(i=t.exec(e));)n.push(i);return n},isHTMLForm:L,hasOwnProperty:B,hasOwnProp:B,reduceDescriptors:U,freezeMethods:t=>{U(t,((e,i)=>{if(p(t)&&-1!==["arguments","caller","callee"].indexOf(i))return!1;const n=t[i];p(n)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")}))}))},toObjectSet:(t,e)=>{const i={},n=t=>{t.forEach((t=>{i[t]=!0}))};return l(t)?n(t):n(String(t).split(e)),i},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,i){return e.toUpperCase()+i})),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:I,global:N,isContextDefined:P,ALPHABET:j,generateString:(t=16,e=j.ALPHA_DIGIT)=>{let i="";const{length:n}=e;for(;t--;)i+=e[Math.random()*n|0];return i},isSpecCompliantForm:function(t){return!!(t&&p(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),i=(t,n)=>{if(m(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[n]=t;const r=l(t)?[]:{};return v(t,((t,e)=>{const s=i(t,n+1);!d(s)&&(r[e]=s)})),e[n]=void 0,r}}return t};return i(t,0)},isAsyncFn:_,isThenable:t=>t&&(m(t)||p(t))&&p(t.then)&&p(t.catch),setImmediate:V,asap:H};function W(t,e,i,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}K.inherits(W,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:K.toJSONObject(this.config),code:this.code,status:this.status}}});const z=W.prototype,Y={};function J(t){return K.isPlainObject(t)||K.isArray(t)}function Q(t){return K.endsWith(t,"[]")?t.slice(0,-2):t}function Z(t,e,i){return t?t.concat(e).map((function(t,e){return t=Q(t),!i&&e?"["+t+"]":t})).join(i?".":""):e}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{Y[t]={value:t}})),Object.defineProperties(W,Y),Object.defineProperty(z,"isAxiosError",{value:!0}),W.from=(t,e,i,n,r,s)=>{const o=Object.create(z);return K.toFlatObject(t,o,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),W.call(o,t.message,e,i,n,r),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const tt=K.toFlatObject(K,{},null,(function(t){return/^is[A-Z]/.test(t)}));function et(t,e,i){if(!K.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const n=(i=K.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!K.isUndefined(e[t])}))).metaTokens,r=i.visitor||c,s=i.dots,o=i.indexes,a=(i.Blob||"undefined"!=typeof Blob&&Blob)&&K.isSpecCompliantForm(e);if(!K.isFunction(r))throw new TypeError("visitor must be a function");function u(t){if(null===t)return"";if(K.isDate(t))return t.toISOString();if(!a&&K.isBlob(t))throw new W("Blob is not supported. Use a Buffer instead.");return K.isArrayBuffer(t)||K.isTypedArray(t)?a&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,i,r){let a=t;if(t&&!r&&"object"==typeof t)if(K.endsWith(i,"{}"))i=n?i:i.slice(0,-2),t=JSON.stringify(t);else if(K.isArray(t)&&function(t){return K.isArray(t)&&!t.some(J)}(t)||(K.isFileList(t)||K.endsWith(i,"[]"))&&(a=K.toArray(t)))return i=Q(i),a.forEach((function(t,n){!K.isUndefined(t)&&null!==t&&e.append(!0===o?Z([i],n,s):null===o?i:i+"[]",u(t))})),!1;return!!J(t)||(e.append(Z(r,i,s),u(t)),!1)}const l=[],d=Object.assign(tt,{defaultVisitor:c,convertValue:u,isVisitable:J});if(!K.isObject(t))throw new TypeError("data must be an object");return function t(i,n){if(!K.isUndefined(i)){if(-1!==l.indexOf(i))throw Error("Circular reference detected in "+n.join("."));l.push(i),K.forEach(i,(function(i,s){!0===(!(K.isUndefined(i)||null===i)&&r.call(e,i,K.isString(s)?s.trim():s,n,d))&&t(i,n?n.concat(s):[s])})),l.pop()}}(t),e}function it(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function nt(t,e){this._pairs=[],t&&et(t,this,e)}const rt=nt.prototype;function st(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ot(t,e,i){if(!e)return t;const n=i&&i.encode||st;K.isFunction(i)&&(i={serialize:i});const r=i&&i.serialize;let s;if(s=r?r(e,i):K.isURLSearchParams(e)?e.toString():new nt(e,i).toString(n),s){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t}rt.append=function(t,e){this._pairs.push([t,e])},rt.toString=function(t){const e=t?function(e){return t.call(this,e,it)}:it;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};var at=class{constructor(){this.handlers=[]}use(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){K.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},ut={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ct={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:nt,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]};const lt="undefined"!=typeof window&&"undefined"!=typeof document,dt="object"==typeof navigator&&navigator||void 0,ft=lt&&(!dt||["ReactNative","NativeScript","NS"].indexOf(dt.product)<0),ht="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,pt=lt&&window.location.href||"http://localhost";var gt={...Object.freeze({__proto__:null,hasBrowserEnv:lt,hasStandardBrowserWebWorkerEnv:ht,hasStandardBrowserEnv:ft,navigator:dt,origin:pt}),...ct};function mt(t){function e(t,i,n,r){let s=t[r++];if("__proto__"===s)return!0;const o=Number.isFinite(+s),a=r>=t.length;return s=!s&&K.isArray(n)?n.length:s,a?(K.hasOwnProp(n,s)?n[s]=[n[s],i]:n[s]=i,!o):(n[s]&&K.isObject(n[s])||(n[s]=[]),e(t,i,n[s],r)&&K.isArray(n[s])&&(n[s]=function(t){const e={},i=Object.keys(t);let n;const r=i.length;let s;for(n=0;n<r;n++)s=i[n],e[s]=t[s];return e}(n[s])),!o)}if(K.isFormData(t)&&K.isFunction(t.entries)){const i={};return K.forEachEntry(t,((t,n)=>{e(function(t){return K.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),n,i,0)})),i}return null}const bt={transitional:ut,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const i=e.getContentType()||"",n=i.indexOf("application/json")>-1,r=K.isObject(t);if(r&&K.isHTMLForm(t)&&(t=new FormData(t)),K.isFormData(t))return n?JSON.stringify(mt(t)):t;if(K.isArrayBuffer(t)||K.isBuffer(t)||K.isStream(t)||K.isFile(t)||K.isBlob(t)||K.isReadableStream(t))return t;if(K.isArrayBufferView(t))return t.buffer;if(K.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(r){if(i.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return et(t,new gt.classes.URLSearchParams,Object.assign({visitor:function(t,e,i,n){return gt.isNode&&K.isBuffer(t)?(this.append(e,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((s=K.isFileList(t))||i.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return et(s?{"files[]":t}:t,e&&new e,this.formSerializer)}}return r||n?(e.setContentType("application/json",!1),function(t){if(K.isString(t))try{return(0,JSON.parse)(t),K.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||bt.transitional,i=e&&e.forcedJSONParsing,n="json"===this.responseType;if(K.isResponse(t)||K.isReadableStream(t))return t;if(t&&K.isString(t)&&(i&&!this.responseType||n)){const i=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(t){if(i){if("SyntaxError"===t.name)throw W.from(t,W.ERR_BAD_RESPONSE,this,null,this.response);throw t}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:gt.classes.FormData,Blob:gt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};K.forEach(["delete","get","head","post","put","patch"],(t=>{bt.headers[t]={}}));var Et=bt;const yt=K.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Tt=Symbol("internals");function wt(t){return t&&String(t).trim().toLowerCase()}function Rt(t){return!1===t||null==t?t:K.isArray(t)?t.map(Rt):String(t)}function At(t,e,i,n,r){return K.isFunction(n)?n.call(this,e,i):(r&&(e=i),K.isString(e)?K.isString(n)?-1!==e.indexOf(n):K.isRegExp(n)?n.test(e):void 0:void 0)}class Dt{constructor(t){t&&this.set(t)}set(t,e,i){const n=this;function r(t,e,i){const r=wt(e);if(!r)throw new Error("header name must be a non-empty string");const s=K.findKey(n,r);(!s||void 0===n[s]||!0===i||void 0===i&&!1!==n[s])&&(n[s||e]=Rt(t))}const s=(t,e)=>K.forEach(t,((t,i)=>r(t,i,e)));if(K.isPlainObject(t)||t instanceof this.constructor)s(t,e);else if(K.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))s((t=>{const e={};let i,n,r;return t&&t.split("\n").forEach((function(t){r=t.indexOf(":"),i=t.substring(0,r).trim().toLowerCase(),n=t.substring(r+1).trim(),!i||e[i]&&yt[i]||("set-cookie"===i?e[i]?e[i].push(n):e[i]=[n]:e[i]=e[i]?e[i]+", "+n:n)})),e})(t),e);else if(K.isHeaders(t))for(const[e,n]of t.entries())r(n,e,i);else null!=t&&r(e,t,i);return this}get(t,e){if(t=wt(t)){const i=K.findKey(this,t);if(i){const t=this[i];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=i.exec(t);)e[n[1]]=n[2];return e}(t);if(K.isFunction(e))return e.call(this,t,i);if(K.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=wt(t)){const i=K.findKey(this,t);return!(!i||void 0===this[i]||e&&!At(0,this[i],i,e))}return!1}delete(t,e){const i=this;let n=!1;function r(t){if(t=wt(t)){const r=K.findKey(i,t);!r||e&&!At(0,i[r],r,e)||(delete i[r],n=!0)}}return K.isArray(t)?t.forEach(r):r(t),n}clear(t){const e=Object.keys(this);let i=e.length,n=!1;for(;i--;){const r=e[i];t&&!At(0,this[r],r,t,!0)||(delete this[r],n=!0)}return n}normalize(t){const e=this,i={};return K.forEach(this,((n,r)=>{const s=K.findKey(i,r);if(s)return e[s]=Rt(n),void delete e[r];const o=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,i)=>e.toUpperCase()+i))}(r):String(r).trim();o!==r&&delete e[r],e[o]=Rt(n),i[o]=!0})),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return K.forEach(this,((i,n)=>{null!=i&&!1!==i&&(e[n]=t&&K.isArray(i)?i.join(", "):i)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([t,e])=>t+": "+e)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const i=new this(t);return e.forEach((t=>i.set(t))),i}static accessor(t){const e=(this[Tt]=this[Tt]={accessors:{}}).accessors,i=this.prototype;function n(t){const n=wt(t);e[n]||(function(t,e){const i=K.toCamelCase(" "+e);["get","set","has"].forEach((n=>{Object.defineProperty(t,n+i,{value:function(t,i,r){return this[n].call(this,e,t,i,r)},configurable:!0})}))}(i,t),e[n]=!0)}return K.isArray(t)?t.forEach(n):n(t),this}}Dt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),K.reduceDescriptors(Dt.prototype,(({value:t},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[i]=t}}})),K.freezeMethods(Dt);var Ot=Dt;function St(t,e){const i=this||Et,n=e||i,r=Ot.from(n.headers);let s=n.data;return K.forEach(t,(function(t){s=t.call(i,s,r.normalize(),e?e.status:void 0)})),r.normalize(),s}function vt(t){return!(!t||!t.__CANCEL__)}function It(t,e,i){W.call(this,null==t?"canceled":t,W.ERR_CANCELED,e,i),this.name="CanceledError"}function Nt(t,e,i){const n=i.config.validateStatus;i.status&&n&&!n(i.status)?e(new W("Request failed with status code "+i.status,[W.ERR_BAD_REQUEST,W.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):t(i)}K.inherits(It,W,{__CANCEL__:!0});const Pt=(t,e,i=3)=>{let n=0;const r=function(t,e){t=t||10;const i=new Array(t),n=new Array(t);let r,s=0,o=0;return e=void 0!==e?e:1e3,function(a){const u=Date.now(),c=n[o];r||(r=u),i[s]=a,n[s]=u;let l=o,d=0;for(;l!==s;)d+=i[l++],l%=t;if(s=(s+1)%t,s===o&&(o=(o+1)%t),u-r<e)return;const f=c&&u-c;return f?Math.round(1e3*d/f):void 0}}(50,250);return function(t,e){let i,n,r=0,s=1e3/e;const o=(e,s=Date.now())=>{r=s,i=null,n&&(clearTimeout(n),n=null),t.apply(null,e)};return[(...t)=>{const e=Date.now(),a=e-r;a>=s?o(t,e):(i=t,n||(n=setTimeout((()=>{n=null,o(i)}),s-a)))},()=>i&&o(i)]}((i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,a=s-n,u=r(a);n=s,t({loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:u||void 0,estimated:u&&o&&s<=o?(o-s)/u:void 0,event:i,lengthComputable:null!=o,[e?"download":"upload"]:!0})}),i)},Ct=(t,e)=>{const i=null!=t;return[n=>e[0]({lengthComputable:i,total:t,loaded:n}),e[1]]},xt=t=>(...e)=>K.asap((()=>t(...e)));var Lt=gt.hasStandardBrowserEnv?((t,e)=>i=>(i=new URL(i,gt.origin),t.protocol===i.protocol&&t.host===i.host&&(e||t.port===i.port)))(new URL(gt.origin),gt.navigator&&/(msie|trident)/i.test(gt.navigator.userAgent)):()=>!0,Bt=gt.hasStandardBrowserEnv?{write(t,e,i,n,r,s){const o=[t+"="+encodeURIComponent(e)];K.isNumber(i)&&o.push("expires="+new Date(i).toGMTString()),K.isString(n)&&o.push("path="+n),K.isString(r)&&o.push("domain="+r),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Mt(t,e){return t&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const Ut=t=>t instanceof Ot?{...t}:t;function Xt(t,e){e=e||{};const i={};function n(t,e,i,n){return K.isPlainObject(t)&&K.isPlainObject(e)?K.merge.call({caseless:n},t,e):K.isPlainObject(e)?K.merge({},e):K.isArray(e)?e.slice():e}function r(t,e,i,r){return K.isUndefined(e)?K.isUndefined(t)?void 0:n(void 0,t,0,r):n(t,e,0,r)}function s(t,e){if(!K.isUndefined(e))return n(void 0,e)}function o(t,e){return K.isUndefined(e)?K.isUndefined(t)?void 0:n(void 0,t):n(void 0,e)}function a(i,r,s){return s in e?n(i,r):s in t?n(void 0,i):void 0}const u={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(t,e,i)=>r(Ut(t),Ut(e),0,!0)};return K.forEach(Object.keys(Object.assign({},t,e)),(function(n){const s=u[n]||r,o=s(t[n],e[n],n);K.isUndefined(o)&&s!==a||(i[n]=o)})),i}var Ft=t=>{const e=Xt({},t);let i,{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:o,headers:a,auth:u}=e;if(e.headers=a=Ot.from(a),e.url=ot(Mt(e.baseURL,e.url),t.params,t.paramsSerializer),u&&a.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),K.isFormData(n))if(gt.hasStandardBrowserEnv||gt.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(i=a.getContentType())){const[t,...e]=i?i.split(";").map((t=>t.trim())).filter(Boolean):[];a.setContentType([t||"multipart/form-data",...e].join("; "))}if(gt.hasStandardBrowserEnv&&(r&&K.isFunction(r)&&(r=r(e)),r||!1!==r&&Lt(e.url))){const t=s&&o&&Bt.read(o);t&&a.set(s,t)}return e},jt="undefined"!=typeof XMLHttpRequest&&function(t){return new Promise((function(e,i){const n=Ft(t);let r=n.data;const s=Ot.from(n.headers).normalize();let o,a,u,c,l,{responseType:d,onUploadProgress:f,onDownloadProgress:h}=n;function p(){c&&c(),l&&l(),n.cancelToken&&n.cancelToken.unsubscribe(o),n.signal&&n.signal.removeEventListener("abort",o)}let g=new XMLHttpRequest;function m(){if(!g)return;const n=Ot.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());Nt((function(t){e(t),p()}),(function(t){i(t),p()}),{data:d&&"text"!==d&&"json"!==d?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:n,config:t,request:g}),g=null}g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(i(new W("Request aborted",W.ECONNABORTED,t,g)),g=null)},g.onerror=function(){i(new W("Network Error",W.ERR_NETWORK,t,g)),g=null},g.ontimeout=function(){let e=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const r=n.transitional||ut;n.timeoutErrorMessage&&(e=n.timeoutErrorMessage),i(new W(e,r.clarifyTimeoutError?W.ETIMEDOUT:W.ECONNABORTED,t,g)),g=null},void 0===r&&s.setContentType(null),"setRequestHeader"in g&&K.forEach(s.toJSON(),(function(t,e){g.setRequestHeader(e,t)})),K.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),d&&"json"!==d&&(g.responseType=n.responseType),h&&([u,l]=Pt(h,!0),g.addEventListener("progress",u)),f&&g.upload&&([a,c]=Pt(f),g.upload.addEventListener("progress",a),g.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(o=e=>{g&&(i(!e||e.type?new It(null,t,g):e),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(o),n.signal&&(n.signal.aborted?o():n.signal.addEventListener("abort",o)));const b=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(n.url);b&&-1===gt.protocols.indexOf(b)?i(new W("Unsupported protocol "+b+":",W.ERR_BAD_REQUEST,t)):g.send(r||null)}))},_t=(t,e)=>{const{length:i}=t=t?t.filter(Boolean):[];if(e||i){let i,n=new AbortController;const r=function(t){if(!i){i=!0,o();const e=t instanceof Error?t:this.reason;n.abort(e instanceof W?e:new It(e instanceof Error?e.message:e))}};let s=e&&setTimeout((()=>{s=null,r(new W(`timeout ${e} of ms exceeded`,W.ETIMEDOUT))}),e);const o=()=>{t&&(s&&clearTimeout(s),s=null,t.forEach((t=>{t.unsubscribe?t.unsubscribe(r):t.removeEventListener("abort",r)})),t=null)};t.forEach((t=>t.addEventListener("abort",r)));const{signal:a}=n;return a.unsubscribe=()=>K.asap(o),a}};const Vt=function*(t,e){let i=t.byteLength;if(!e||i<e)return void(yield t);let n,r=0;for(;r<i;)n=r+e,yield t.slice(r,n),r=n},kt=(t,e,i,n)=>{const r=async function*(t,e){for await(const i of async function*(t){if(t[Symbol.asyncIterator])return void(yield*t);const e=t.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}}(t))yield*Vt(i,e)}(t,e);let s,o=0,a=t=>{s||(s=!0,n&&n(t))};return new ReadableStream({async pull(t){try{const{done:e,value:n}=await r.next();if(e)return a(),void t.close();let s=n.byteLength;if(i){let t=o+=s;i(t)}t.enqueue(new Uint8Array(n))}catch(t){throw a(t),t}},cancel:t=>(a(t),r.return())},{highWaterMark:2})},$t="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,qt=$t&&"function"==typeof ReadableStream,Gt=$t&&("function"==typeof TextEncoder?(Ht=new TextEncoder,t=>Ht.encode(t)):async t=>new Uint8Array(await new Response(t).arrayBuffer()));var Ht;const Kt=(t,...e)=>{try{return!!t(...e)}catch(t){return!1}},Wt=qt&&Kt((()=>{let t=!1;const e=new Request(gt.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e})),zt=qt&&Kt((()=>K.isReadableStream(new Response("").body))),Yt={stream:zt&&(t=>t.body)};var Jt;$t&&(Jt=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((t=>{!Yt[t]&&(Yt[t]=K.isFunction(Jt[t])?e=>e[t]():(e,i)=>{throw new W(`Response type '${t}' is not supported`,W.ERR_NOT_SUPPORT,i)})})));const Qt={http:null,xhr:jt,fetch:$t&&(async t=>{let{url:e,method:i,data:n,signal:r,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:u,responseType:c,headers:l,withCredentials:d="same-origin",fetchOptions:f}=Ft(t);c=c?(c+"").toLowerCase():"text";let h,p=_t([r,s&&s.toAbortSignal()],o);const g=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let m;try{if(u&&Wt&&"get"!==i&&"head"!==i&&0!==(m=await(async(t,e)=>{const i=K.toFiniteNumber(t.getContentLength());return null==i?(async t=>{if(null==t)return 0;if(K.isBlob(t))return t.size;if(K.isSpecCompliantForm(t)){const e=new Request(gt.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return K.isArrayBufferView(t)||K.isArrayBuffer(t)?t.byteLength:(K.isURLSearchParams(t)&&(t+=""),K.isString(t)?(await Gt(t)).byteLength:void 0)})(e):i})(l,n))){let t,i=new Request(e,{method:"POST",body:n,duplex:"half"});if(K.isFormData(n)&&(t=i.headers.get("content-type"))&&l.setContentType(t),i.body){const[t,e]=Ct(m,Pt(xt(u)));n=kt(i.body,65536,t,e)}}K.isString(d)||(d=d?"include":"omit");const r="credentials"in Request.prototype;h=new Request(e,{...f,signal:p,method:i.toUpperCase(),headers:l.normalize().toJSON(),body:n,duplex:"half",credentials:r?d:void 0});let s=await fetch(h);const o=zt&&("stream"===c||"response"===c);if(zt&&(a||o&&g)){const t={};["status","statusText","headers"].forEach((e=>{t[e]=s[e]}));const e=K.toFiniteNumber(s.headers.get("content-length")),[i,n]=a&&Ct(e,Pt(xt(a),!0))||[];s=new Response(kt(s.body,65536,i,(()=>{n&&n(),g&&g()})),t)}c=c||"text";let b=await Yt[K.findKey(Yt,c)||"text"](s,t);return!o&&g&&g(),await new Promise(((e,i)=>{Nt(e,i,{data:b,headers:Ot.from(s.headers),status:s.status,statusText:s.statusText,config:t,request:h})}))}catch(e){if(g&&g(),e&&"TypeError"===e.name&&/fetch/i.test(e.message))throw Object.assign(new W("Network Error",W.ERR_NETWORK,t,h),{cause:e.cause||e});throw W.from(e,e&&e.code,t,h)}})};K.forEach(Qt,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(t){}Object.defineProperty(t,"adapterName",{value:e})}}));const Zt=t=>`- ${t}`,te=t=>K.isFunction(t)||null===t||!1===t;var ee=t=>{t=K.isArray(t)?t:[t];const{length:e}=t;let i,n;const r={};for(let s=0;s<e;s++){let e;if(i=t[s],n=i,!te(i)&&(n=Qt[(e=String(i)).toLowerCase()],void 0===n))throw new W(`Unknown adapter '${e}'`);if(n)break;r[e||"#"+s]=n}if(!n){const t=Object.entries(r).map((([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build")));throw new W("There is no suitable adapter to dispatch the request "+(e?t.length>1?"since :\n"+t.map(Zt).join("\n"):" "+Zt(t[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return n};function ie(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new It(null,t)}function ne(t){return ie(t),t.headers=Ot.from(t.headers),t.data=St.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1),ee(t.adapter||Et.adapter)(t).then((function(e){return ie(t),e.data=St.call(t,t.transformResponse,e),e.headers=Ot.from(e.headers),e}),(function(e){return vt(e)||(ie(t),e&&e.response&&(e.response.data=St.call(t,t.transformResponse,e.response),e.response.headers=Ot.from(e.response.headers))),Promise.reject(e)}))}const re={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{re[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}}));const se={};re.transitional=function(t,e,i){function n(t,e){return"[Axios v1.7.9] Transitional option '"+t+"'"+e+(i?". "+i:"")}return(i,r,s)=>{if(!1===t)throw new W(n(r," has been removed"+(e?" in "+e:"")),W.ERR_DEPRECATED);return e&&!se[r]&&(se[r]=!0,console.warn(n(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(i,r,s)}},re.spelling=function(t){return(e,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};var oe={assertOptions:function(t,e,i){if("object"!=typeof t)throw new W("options must be an object",W.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let r=n.length;for(;r-- >0;){const s=n[r],o=e[s];if(o){const e=t[s],i=void 0===e||o(e,s,t);if(!0!==i)throw new W("option "+s+" must be "+i,W.ERR_BAD_OPTION_VALUE)}else if(!0!==i)throw new W("Unknown option "+s,W.ERR_BAD_OPTION)}},validators:re};const ae=oe.validators;class ue{constructor(t){this.defaults=t,this.interceptors={request:new at,response:new at}}async request(t,e){try{return await this._request(t,e)}catch(t){if(t instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const i=e.stack?e.stack.replace(/^.+\n/,""):"";try{t.stack?i&&!String(t.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(t.stack+="\n"+i):t.stack=i}catch(t){}}throw t}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=Xt(this.defaults,e);const{transitional:i,paramsSerializer:n,headers:r}=e;void 0!==i&&oe.assertOptions(i,{silentJSONParsing:ae.transitional(ae.boolean),forcedJSONParsing:ae.transitional(ae.boolean),clarifyTimeoutError:ae.transitional(ae.boolean)},!1),null!=n&&(K.isFunction(n)?e.paramsSerializer={serialize:n}:oe.assertOptions(n,{encode:ae.function,serialize:ae.function},!0)),oe.assertOptions(e,{baseUrl:ae.spelling("baseURL"),withXsrfToken:ae.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=r&&K.merge(r.common,r[e.method]);r&&K.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete r[t]})),e.headers=Ot.concat(s,r);const o=[];let a=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(a=a&&t.synchronous,o.unshift(t.fulfilled,t.rejected))}));const u=[];let c;this.interceptors.response.forEach((function(t){u.push(t.fulfilled,t.rejected)}));let l,d=0;if(!a){const t=[ne.bind(this),void 0];for(t.unshift.apply(t,o),t.push.apply(t,u),l=t.length,c=Promise.resolve(e);d<l;)c=c.then(t[d++],t[d++]);return c}l=o.length;let f=e;for(d=0;d<l;){const t=o[d++],e=o[d++];try{f=t(f)}catch(t){e.call(this,t);break}}try{c=ne.call(this,f)}catch(t){return Promise.reject(t)}for(d=0,l=u.length;d<l;)c=c.then(u[d++],u[d++]);return c}getUri(t){return ot(Mt((t=Xt(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}K.forEach(["delete","get","head","options"],(function(t){ue.prototype[t]=function(e,i){return this.request(Xt(i||{},{method:t,url:e,data:(i||{}).data}))}})),K.forEach(["post","put","patch"],(function(t){function e(e){return function(i,n,r){return this.request(Xt(r||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:i,data:n}))}}ue.prototype[t]=e(),ue.prototype[t+"Form"]=e(!0)}));var ce=ue;class le{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const i=this;this.promise.then((t=>{if(!i._listeners)return;let e=i._listeners.length;for(;e-- >0;)i._listeners[e](t);i._listeners=null})),this.promise.then=t=>{let e;const n=new Promise((t=>{i.subscribe(t),e=t})).then(t);return n.cancel=function(){i.unsubscribe(e)},n},t((function(t,n,r){i.reason||(i.reason=new It(t,n,r),e(i.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new le((function(e){t=e})),cancel:t}}}var de=le;const fe={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(fe).forEach((([t,e])=>{fe[e]=t}));var he=fe;const pe=function t(e){const i=new ce(e),r=n(ce.prototype.request,i);return K.extend(r,ce.prototype,i,{allOwnKeys:!0}),K.extend(r,i,null,{allOwnKeys:!0}),r.create=function(i){return t(Xt(e,i))},r}(Et);pe.Axios=ce,pe.CanceledError=It,pe.CancelToken=de,pe.isCancel=vt,pe.VERSION="1.7.9",pe.toFormData=et,pe.AxiosError=W,pe.Cancel=pe.CanceledError,pe.all=function(t){return Promise.all(t)},pe.spread=function(t){return function(e){return t.apply(null,e)}},pe.isAxiosError=function(t){return K.isObject(t)&&!0===t.isAxiosError},pe.mergeConfig=Xt,pe.AxiosHeaders=Ot,pe.formToJSON=t=>mt(K.isHTMLForm(t)?new FormData(t):t),pe.getAdapter=ee,pe.HttpStatusCode=he,pe.default=pe,t.exports=pe},531:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function a(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}u((n=n.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=r(i(425)),o=i(858),a=i(216),u=r(i(820));e.default=class{constructor(){this.updateCountDownload=t=>{this.countDownload<=0||("RESET"!==t?"INCREASE"!==t?"DESCREASE"!==t||(this.countDownload=this.countDownload-1):this.countDownload=this.countDownload+1:this.countDownload=0)},this.idVideoIDB="1",this.onProgress=()=>{},this.countDownload=0,this.progress={},this.videosWaiting=[],this.infoVideoDownload={}}fetchThumbnail(t){return n(this,void 0,void 0,(function*(){try{const e=yield fetch(t),i=yield e.arrayBuffer();return new Uint8Array(i)}catch(t){return null}}))}fetchM3u8Url(t){return n(this,void 0,void 0,(function*(){var e,i,n;const r=t.indexOf(".m3u8"),a=t.substring(0,t.lastIndexOf("/",r)),u=(yield s.default.get(t)).data,c=new o.Parser;if(c.push(u),c.end(),(null===(e=c.manifest.playlists)||void 0===e?void 0:e.length)&&c.manifest.playlists.length>0){const t=null===(n=null===(i=c.manifest)||void 0===i?void 0:i.playlists[0])||void 0===n?void 0:n.uri,e=`${a}/${t}`,r=e.indexOf(".m3u8"),u=e.substring(0,e.lastIndexOf("/",r)),l=yield s.default.get(e),d=new o.Parser;return d.push(l.data),d.end(),d.manifest.segments.map((t=>u+"/"+t.uri))}if(c.manifest.segments.length>0)return c.manifest.segments.map((t=>a+"/"+t.uri))}))}fetchSegments(t){return n(this,void 0,void 0,(function*(){for(const e of t)try{yield this.fetchChunk(e)}catch(t){throw t}}))}fetchChunk(t){return n(this,void 0,void 0,(function*(){if(!navigator.onLine||!this.infoVideoDownload[this.idVideoIDB])return;if(this.infoVideoDownload[this.idVideoIDB].isPaused)return;if(this.countDownload>a.MAX_VIDEOS_DOWNLOADING)return;const e=yield(yield fetch(t)).arrayBuffer(),i=new Uint8Array(e);this.infoVideoDownload[this.idVideoIDB].arr.push(i);const n=Math.floor(this.infoVideoDownload[this.idVideoIDB].arr.length/this.infoVideoDownload[this.idVideoIDB].totalSegments*100);this.progress[this.idVideoIDB]=n,this.onProgress&&this.onProgress({id:this.idVideoIDB,progress:n}),n>100||(yield u.default.save(this.idVideoIDB,this.infoVideoDownload[this.idVideoIDB]))}))}start(t,e,i,r,s){return n(this,void 0,void 0,(function*(){if(this.infoVideoDownload[e]={url:t,isPaused:!1,arr:[],totalSegments:0,thumbnail:i,metadata:r},this.idVideoIDB=e,this.onProgress=s,this.progress[e]=0,i){const t=yield this.fetchThumbnail(i);this.infoVideoDownload[e].thumbnail=t}if(yield u.default.save(e,this.infoVideoDownload[e]),this.countDownload>=a.MAX_VIDEOS_DOWNLOADING)return void(this.videosWaiting=[...this.videosWaiting,this.infoVideoDownload[e]]);this.updateCountDownload("INCREASE");const n=yield this.fetchM3u8Url(t);if(!n)throw new Error("No segments found");this.infoVideoDownload[e].totalSegments=n.length,this.infoVideoDownload[e].segments=n,yield u.default.save(e,this.infoVideoDownload[e]),yield this.fetchSegments(n)}))}pause(t){return n(this,void 0,void 0,(function*(){this.infoVideoDownload[t].arr.length!==this.infoVideoDownload[t].totalSegments&&(this.infoVideoDownload[t].isPaused=!0,this.updateCountDownload("DESCREASE"),yield u.default.save(t,this.infoVideoDownload[t]))}))}resume(t){return n(this,void 0,void 0,(function*(){this.infoVideoDownload[t].arr.length!==this.infoVideoDownload[t].totalSegments&&(this.infoVideoDownload[t].isPaused=!1,this.updateCountDownload("INCREASE"),yield this.fetchSegments(this.infoVideoDownload[t].segments))}))}cancel(t){return n(this,void 0,void 0,(function*(){this.infoVideoDownload[t].isPaused=!0,delete this.infoVideoDownload[t],this.updateCountDownload("DESCREASE"),yield u.default.delete(t)}))}deleteVideo(t){return n(this,void 0,void 0,(function*(){yield u.default.delete(t)}))}getVideo(t){return n(this,void 0,void 0,(function*(){return yield u.default.get(t)}))}getThumbnailVideoDownloaded(t){return n(this,void 0,void 0,(function*(){const e=yield u.default.get(t);return(null==e?void 0:e.thumbnail)?URL.createObjectURL(new Blob([e.thumbnail],{type:"image/png"})):null}))}getAllVideos(){return n(this,void 0,void 0,(function*(){return yield u.default.getAll()}))}deleteAllVideos(){return n(this,void 0,void 0,(function*(){return yield u.default.deleteAll()}))}}},602:(t,e,i)=>{"use strict";i.r(e),i.d(e,{deleteDB:()=>g,openDB:()=>p,unwrap:()=>h,wrap:()=>f});const n=(t,e)=>e.some((e=>t instanceof e));let r,s;const o=new WeakMap,a=new WeakMap,u=new WeakMap;let c={get(t,e,i){if(t instanceof IDBTransaction){if("done"===e)return o.get(t);if("store"===e)return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return f(t[e])},set:(t,e,i)=>(t[e]=i,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function l(t){c=t(c)}function d(t){return"function"==typeof t?(e=t,(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(h(this),t),f(this.request)}:function(...t){return f(e.apply(h(this),t))}):(t instanceof IDBTransaction&&function(t){if(o.has(t))return;const e=new Promise(((e,i)=>{const n=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),n()},s=()=>{i(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));o.set(t,e)}(t),n(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,c):t);var e}function f(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,i)=>{const n=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(f(t.result)),n()},s=()=>{i(t.error),n()};t.addEventListener("success",r),t.addEventListener("error",s)}));return u.set(e,t),e}(t);if(a.has(t))return a.get(t);const e=d(t);return e!==t&&(a.set(t,e),u.set(e,t)),e}const h=t=>u.get(t);function p(t,e,{blocked:i,upgrade:n,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=f(o);return n&&o.addEventListener("upgradeneeded",(t=>{n(f(o.result),t.oldVersion,t.newVersion,f(o.transaction),t)})),i&&o.addEventListener("blocked",(t=>i(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}function g(t,{blocked:e}={}){const i=indexedDB.deleteDatabase(t);return e&&i.addEventListener("blocked",(t=>e(t.oldVersion,t))),f(i).then((()=>{}))}const m=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],E=new Map;function y(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(E.get(e))return E.get(e);const i=e.replace(/FromIndex$/,""),n=e!==i,r=b.includes(i);if(!(i in(n?IDBIndex:IDBObjectStore).prototype)||!r&&!m.includes(i))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return n&&(o=o.index(e.shift())),(await Promise.all([o[i](...e),r&&s.done]))[0]};return E.set(e,s),s}l((t=>({...t,get:(e,i,n)=>y(e,i)||t.get(e,i,n),has:(e,i)=>!!y(e,i)||t.has(e,i)})));const T=["continue","continuePrimaryKey","advance"],w={},R=new WeakMap,A=new WeakMap,D={get(t,e){if(!T.includes(e))return t[e];let i=w[e];return i||(i=w[e]=function(...t){R.set(this,A.get(this)[e](...t))}),i}};async function*O(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const i=new Proxy(e,D);for(A.set(i,e),u.set(i,h(e));e;)yield i,e=await(R.get(i)||e.continue()),R.delete(i)}function S(t,e){return e===Symbol.asyncIterator&&n(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&n(t,[IDBIndex,IDBObjectStore])}l((t=>({...t,get:(e,i,n)=>S(e,i)?O:t.get(e,i,n),has:(e,i)=>S(e,i)||t.has(e,i)})))},794:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function a(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}u((n=n.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=r(i(531)),o=r(i(820));e.default=class{constructor(t){this.url=t.url,this.idVideoIDB=t.idVideoIDB,this.thumbnail=t.thumbnail,this.metadata=t.metadata,this.onSuccess=t.onSuccess,this.onProgress=t.onProgress,this.onPause=t.onPause,this.onResume=t.onResume,this.onCancel=t.onCancel,this.onDelete=t.onDelete,this.onDeleteAll=t.onDeleteAll,this.downloadManager=new s.default,this.initPromise=this.init()}init(){return n(this,void 0,void 0,(function*(){yield o.default.init(),console.log("HLSDownloader initialized")}))}ensureInit(){return n(this,void 0,void 0,(function*(){yield this.initPromise}))}start(){return n(this,void 0,void 0,(function*(){console.log(`Start downloading: ${this.url}`),yield this.ensureInit(),yield this.downloadManager.start(this.url,this.idVideoIDB,this.thumbnail,this.metadata,this.onProgress,this.onDeleteAll),this.onSuccess&&this.onSuccess()}))}pause(){return n(this,void 0,void 0,(function*(){console.log("Pause downloading"),yield this.ensureInit(),yield this.downloadManager.pause(this.idVideoIDB),this.onPause&&this.onPause()}))}resume(){return n(this,void 0,void 0,(function*(){console.log("Resume downloading"),yield this.ensureInit(),yield this.downloadManager.resume(this.idVideoIDB),this.onResume&&this.onResume()}))}cancel(){return n(this,void 0,void 0,(function*(){yield this.ensureInit(),console.log("Cancel downloading"),yield this.downloadManager.cancel(this.idVideoIDB),this.onCancel&&this.onCancel()}))}deleteVideo(t){return n(this,void 0,void 0,(function*(){yield this.ensureInit(),console.log("Delete video"),yield this.downloadManager.deleteVideo(t),this.onDelete&&this.onDelete()}))}getVideo(t){return n(this,void 0,void 0,(function*(){return yield this.ensureInit(),yield this.downloadManager.getVideo(t)}))}getThumbnailVideoDownloaded(t){return n(this,void 0,void 0,(function*(){return yield this.ensureInit(),yield this.downloadManager.getThumbnailVideoDownloaded(t)}))}getAllVideos(){return n(this,void 0,void 0,(function*(){return yield this.ensureInit(),yield this.downloadManager.getAllVideos()}))}deleteAllVideos(){return n(this,void 0,void 0,(function*(){yield this.ensureInit(),yield this.downloadManager.deleteAllVideos(),this.onDeleteAll&&this.onDeleteAll()}))}}},820:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function a(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const r=i(602);class s{constructor(){return this.dbName="hls-downloader",this.storeName="video",this.dbVersion=1,s.instance||(this.db=null,s.instance=this),s.instance}init(){return n(this,void 0,void 0,(function*(){try{this.db=yield(0,r.openDB)(this.dbName,this.dbVersion,{upgrade:t=>{t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName)}}),console.log("IndexedDB initialized")}catch(t){console.error("Error opening IndexedDB:",t)}}))}save(t,e){return n(this,void 0,void 0,(function*(){if(this.db)try{const i=this.db.transaction(this.storeName,"readwrite"),n=i.objectStore(this.storeName);yield n.put(e,t),yield i.done}catch(t){console.error("Error saving to IndexedDB:",t)}else console.warn("Database is not initialized")}))}delete(t){return n(this,void 0,void 0,(function*(){if(this.db)try{const e=this.db.transaction(this.storeName,"readwrite"),i=e.objectStore(this.storeName);yield i.delete(t),yield e.done}catch(t){console.error("Error deleting from IndexedDB:",t)}else console.warn("Database is not initialized")}))}get(t){return n(this,void 0,void 0,(function*(){if(!this.db)return console.warn("Database is not initialized"),null;try{const e=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName);return yield e.get(t)}catch(t){return console.error("Error getting data from IndexedDB:",t),null}}))}getAll(){return n(this,void 0,void 0,(function*(){if(!this.db)return console.warn("Database is not initialized"),null;try{const t=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName);return yield t.getAll()}catch(t){return console.error("Error getting data from IndexedDB:",t),null}}))}deleteAll(){return n(this,void 0,void 0,(function*(){if(!this.db)return console.warn("Database is not initialized"),null;let t=yield this.db.transaction(this.storeName,"readwrite").store.openCursor();for(;t;)yield t.delete(),t=yield t.continue()}))}}const o=new s;e.default=o},840:(t,e,i)=>{var n;n="undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{},t.exports=n},858:(t,e,i)=>{"use strict";i.r(e),i.d(e,{LineStream:()=>u,ParseStream:()=>h,Parser:()=>m});var n=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.off=function(t,e){if(!this.listeners[t])return!1;var i=this.listeners[t].indexOf(e);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(i,1),i>-1},e.trigger=function(t){var e=this.listeners[t];if(e)if(2===arguments.length)for(var i=e.length,n=0;n<i;++n)e[n].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),s=e.length,o=0;o<s;++o)e[o].apply(this,r)},e.dispose=function(){this.listeners={}},e.pipe=function(t){this.on("data",(function(e){t.push(e)}))},t}();function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},r.apply(null,arguments)}var s=i(840),o=i.n(s);function a(t){for(var e,i=(e=t,o().atob?o().atob(e):Buffer.from(e,"base64").toString("binary")),n=new Uint8Array(i.length),r=0;r<i.length;r++)n[r]=i.charCodeAt(r);return n}class u extends n{constructor(){super(),this.buffer=""}push(t){let e;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)}}const c=String.fromCharCode(9),l=function(t){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(t||""),i={};return e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),i},d=function(t){const e={};if(!t)return e;const i=t.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'));let n,r=i.length;for(;r--;)""!==i[r]&&(n=/([^=]*)=(.*)/.exec(i[r]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),e[n[0]]=n[1]);return e},f=t=>{const e=t.split("x"),i={};return e[0]&&(i.width=parseInt(e[0],10)),e[1]&&(i.height=parseInt(e[1],10)),i};class h extends n{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(t){let e,i;0!==(t=t.trim()).length&&("#"===t[0]?this.tagMappers.reduce(((e,i)=>{const n=i(t);return n===t?e:e.concat([n])}),[t]).forEach((t=>{for(let e=0;e<this.customParsers.length;e++)if(this.customParsers[e].call(this,t))return;if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t),e)this.trigger("data",{type:"tag",tagType:"m3u"});else{if(e=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(t),e)return i={type:"tag",tagType:"inf"},e[1]&&(i.duration=parseFloat(e[1])),e[2]&&(i.title=e[2]),void this.trigger("data",i);if(e=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"targetduration"},e[1]&&(i.duration=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-VERSION:([0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"version"},e[1]&&(i.version=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"media-sequence"},e[1]&&(i.number=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(i.number=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(t),e)return i={type:"tag",tagType:"playlist-type"},e[1]&&(i.playlistType=e[1]),void this.trigger("data",i);if(e=/^#EXT-X-BYTERANGE:(.*)?$/.exec(t),e)return i=r(l(e[1]),{type:"tag",tagType:"byterange"}),void this.trigger("data",i);if(e=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(t),e)return i={type:"tag",tagType:"allow-cache"},e[1]&&(i.allowed=!/NO/.test(e[1])),void this.trigger("data",i);if(e=/^#EXT-X-MAP:(.*)$/.exec(t),e){if(i={type:"tag",tagType:"map"},e[1]){const t=d(e[1]);t.URI&&(i.uri=t.URI),t.BYTERANGE&&(i.byterange=l(t.BYTERANGE))}this.trigger("data",i)}else{if(e=/^#EXT-X-STREAM-INF:(.*)$/.exec(t),e)return i={type:"tag",tagType:"stream-inf"},e[1]&&(i.attributes=d(e[1]),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=f(i.attributes.RESOLUTION)),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))),void this.trigger("data",i);if(e=/^#EXT-X-MEDIA:(.*)$/.exec(t),e)return i={type:"tag",tagType:"media"},e[1]&&(i.attributes=d(e[1])),void this.trigger("data",i);if(e=/^#EXT-X-ENDLIST/.exec(t),e)this.trigger("data",{type:"tag",tagType:"endlist"});else if(e=/^#EXT-X-DISCONTINUITY/.exec(t),e)this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(e=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(t),e)return i={type:"tag",tagType:"program-date-time"},e[1]&&(i.dateTimeString=e[1],i.dateTimeObject=new Date(e[1])),void this.trigger("data",i);if(e=/^#EXT-X-KEY:(.*)$/.exec(t),e)return i={type:"tag",tagType:"key"},e[1]&&(i.attributes=d(e[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void this.trigger("data",i);if(e=/^#EXT-X-START:(.*)$/.exec(t),e)return i={type:"tag",tagType:"start"},e[1]&&(i.attributes=d(e[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),void this.trigger("data",i);if(e=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(t),e)return i={type:"tag",tagType:"cue-out-cont"},e[1]?i.data=e[1]:i.data="",void this.trigger("data",i);if(e=/^#EXT-X-CUE-OUT:(.*)?$/.exec(t),e)return i={type:"tag",tagType:"cue-out"},e[1]?i.data=e[1]:i.data="",void this.trigger("data",i);if(e=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t),e)return i={type:"tag",tagType:"cue-in"},e[1]?i.data=e[1]:i.data="",void this.trigger("data",i);if(e=/^#EXT-X-SKIP:(.*)$/.exec(t),e&&e[1])return i={type:"tag",tagType:"skip"},i.attributes=d(e[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(c)),void this.trigger("data",i);if(e=/^#EXT-X-PART:(.*)$/.exec(t),e&&e[1])return i={type:"tag",tagType:"part"},i.attributes=d(e[1]),["DURATION"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))})),["INDEPENDENT","GAP"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=/YES/.test(i.attributes[t]))})),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=l(i.attributes.BYTERANGE)),void this.trigger("data",i);if(e=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(t),e&&e[1])return i={type:"tag",tagType:"server-control"},i.attributes=d(e[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=/YES/.test(i.attributes[t]))})),void this.trigger("data",i);if(e=/^#EXT-X-PART-INF:(.*)$/.exec(t),e&&e[1])return i={type:"tag",tagType:"part-inf"},i.attributes=d(e[1]),["PART-TARGET"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))})),void this.trigger("data",i);if(e=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(t),e&&e[1])return i={type:"tag",tagType:"preload-hint"},i.attributes=d(e[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(t){if(i.attributes.hasOwnProperty(t)){i.attributes[t]=parseInt(i.attributes[t],10);const e="BYTERANGE-LENGTH"===t?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[e]=i.attributes[t],delete i.attributes[t]}})),void this.trigger("data",i);if(e=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(t),e&&e[1])return i={type:"tag",tagType:"rendition-report"},i.attributes=d(e[1]),["LAST-MSN","LAST-PART"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseInt(i.attributes[t],10))})),void this.trigger("data",i);if(e=/^#EXT-X-DATERANGE:(.*)$/.exec(t),e&&e[1]){i={type:"tag",tagType:"daterange"},i.attributes=d(e[1]),["ID","CLASS"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=String(i.attributes[t]))})),["START-DATE","END-DATE"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=new Date(i.attributes[t]))})),["DURATION","PLANNED-DURATION"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))})),["END-ON-NEXT"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=/YES/i.test(i.attributes[t]))})),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach((function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=i.attributes[t].toString(16))}));const t=/^X-([A-Z]+-)+[A-Z]+$/;for(const e in i.attributes){if(!t.test(e))continue;const n=/[0-9A-Fa-f]{6}/g.test(i.attributes[e]),r=/^\d+(\.\d+)?$/.test(i.attributes[e]);i.attributes[e]=n?i.attributes[e].toString(16):r?parseFloat(i.attributes[e]):String(i.attributes[e])}this.trigger("data",i)}else if(e=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(t),e)this.trigger("data",{type:"tag",tagType:"independent-segments"});else if(e=/^#EXT-X-I-FRAMES-ONLY/.exec(t),e)this.trigger("data",{type:"tag",tagType:"i-frames-only"});else{if(e=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(t),e)return i={type:"tag",tagType:"content-steering"},i.attributes=d(e[1]),void this.trigger("data",i);if(e=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(t),e)return i={type:"tag",tagType:"i-frame-playlist"},i.attributes=d(e[1]),i.attributes.URI&&(i.uri=i.attributes.URI),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=f(i.attributes.RESOLUTION)),i.attributes["AVERAGE-BANDWIDTH"]&&(i.attributes["AVERAGE-BANDWIDTH"]=parseInt(i.attributes["AVERAGE-BANDWIDTH"],10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),void this.trigger("data",i);if(e=/^#EXT-X-DEFINE:(.*)$/.exec(t),e)return i={type:"tag",tagType:"define"},i.attributes=d(e[1]),void this.trigger("data",i);this.trigger("data",{type:"tag",data:t.slice(4)})}}}}else this.trigger("data",{type:"comment",text:t.slice(1)})})):this.trigger("data",{type:"uri",uri:t}))}addParser({expression:t,customType:e,dataParser:i,segment:n}){"function"!=typeof i&&(i=t=>t),this.customParsers.push((r=>{if(t.exec(r))return this.trigger("data",{type:"custom",data:i(r),customType:e,segment:n}),!0}))}addTagMapper({expression:t,map:e}){this.tagMappers.push((i=>t.test(i)?e(i):i))}}const p=function(t){const e={};return Object.keys(t).forEach((function(i){var n;e[(n=i,n.toLowerCase().replace(/-(\w)/g,(t=>t[1].toUpperCase())))]=t[i]})),e},g=function(t){const{serverControl:e,targetDuration:i,partTargetDuration:n}=t;if(!e)return;const r="#EXT-X-SERVER-CONTROL",s="holdBack",o="partHoldBack",a=i&&3*i,u=n&&2*n;i&&!e.hasOwnProperty(s)&&(e[s]=a,this.trigger("info",{message:`${r} defaulting HOLD-BACK to targetDuration * 3 (${a}).`})),a&&e[s]<a&&(this.trigger("warn",{message:`${r} clamping HOLD-BACK (${e[s]}) to targetDuration * 3 (${a})`}),e[s]=a),n&&!e.hasOwnProperty(o)&&(e[o]=3*n,this.trigger("info",{message:`${r} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[o]}).`})),n&&e[o]<u&&(this.trigger("warn",{message:`${r} clamping PART-HOLD-BACK (${e[o]}) to partTargetDuration * 2 (${u}).`}),e[o]=u)};class m extends n{constructor(t={}){super(),this.lineStream=new u,this.parseStream=new h,this.lineStream.pipe(this.parseStream),this.mainDefinitions=t.mainDefinitions||{},this.params=new URL(t.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const e=this,i=[];let n,s,o={},c=!1;const l=function(){},d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};let f=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let m=0,b=0;const E={};this.on("end",(()=>{o.uri||!o.parts&&!o.preloadHints||(!o.map&&n&&(o.map=n),!o.key&&s&&(o.key=s),o.timeline||"number"!=typeof f||(o.timeline=f),this.manifest.preloadSegment=o)})),this.parseStream.on("data",(function(t){let u,h;if(e.manifest.definitions)for(const i in e.manifest.definitions)if(t.uri&&(t.uri=t.uri.replace(`{$${i}}`,e.manifest.definitions[i])),t.attributes)for(const n in t.attributes)"string"==typeof t.attributes[n]&&(t.attributes[n]=t.attributes[n].replace(`{$${i}}`,e.manifest.definitions[i]));({tag(){({version(){t.version&&(this.manifest.version=t.version)},"allow-cache"(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const e={};"length"in t&&(o.byterange=e,e.length=t.length,"offset"in t||(t.offset=m)),"offset"in t&&(o.byterange=e,e.offset=t.offset),m=e.offset+e.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),t.title&&(o.title=t.title),t.duration>0&&(o.duration=t.duration),0===t.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(t.attributes)if("NONE"!==t.attributes.METHOD)if(t.attributes.URI){if("com.apple.streamingkeydelivery"===t.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:t.attributes});if("com.microsoft.playready"===t.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.microsoft.playready"]={uri:t.attributes.URI});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT)return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==t.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)},pssh:a(t.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),s={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void 0!==t.attributes.IV&&(s.iv=t.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else s=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence"(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence"(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,f=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type"(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map(){n={},t.uri&&(n.uri=t.uri),t.byterange&&(n.byterange=t.byterange),s&&(n.key=s)},"stream-inf"(){this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||d,t.attributes?(o.attributes||(o.attributes={}),r(o.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||d,!(t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME))return void this.trigger("warn",{message:"ignoring incomplete or missing media group"});const e=this.manifest.mediaGroups[t.attributes.TYPE];e[t.attributes["GROUP-ID"]]=e[t.attributes["GROUP-ID"]]||{},u=e[t.attributes["GROUP-ID"]],h={default:/yes/i.test(t.attributes.DEFAULT)},h.default?h.autoselect=!0:h.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(h.language=t.attributes.LANGUAGE),t.attributes.URI&&(h.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(h.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(h.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(h.forced=/yes/i.test(t.attributes.FORCED)),u[t.attributes.NAME]=h},discontinuity(){f+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),o.dateTimeString=t.dateTimeString,o.dateTimeObject=t.dateTimeObject;const{lastProgramDateTime:e}=this;this.lastProgramDateTime=new Date(t.dateTimeString).getTime(),null===e&&this.manifest.segments.reduceRight(((t,e)=>(e.programDateTime=t-1e3*e.duration,e.programDateTime)),this.lastProgramDateTime)},targetduration(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):(this.manifest.targetDuration=t.duration,g.call(this,this.manifest))},start(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out"(){o.cueOut=t.data},"cue-out-cont"(){o.cueOutCont=t.data},"cue-in"(){o.cueIn=t.data},skip(){this.manifest.skip=p(t.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",t.attributes,["SKIPPED-SEGMENTS"])},part(){c=!0;const e=this.manifest.segments.length,i=p(t.attributes);o.parts=o.parts||[],o.parts.push(i),i.byterange&&(i.byterange.hasOwnProperty("offset")||(i.byterange.offset=b),b=i.byterange.offset+i.byterange.length);const n=o.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${n} for segment #${e}`,t.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(((t,e)=>{t.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${e} lacks required attribute(s): LAST-PART`})}))},"server-control"(){const e=this.manifest.serverControl=p(t.attributes);e.hasOwnProperty("canBlockReload")||(e.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),g.call(this,this.manifest),e.canSkipDateranges&&!e.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const e=this.manifest.segments.length,i=p(t.attributes),n=i.type&&"PART"===i.type;o.preloadHints=o.preloadHints||[],o.preloadHints.push(i),i.byterange&&(i.byterange.hasOwnProperty("offset")||(i.byterange.offset=n?b:0,n&&(b=i.byterange.offset+i.byterange.length)));const r=o.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${r} for segment #${e}`,t.attributes,["TYPE","URI"]),i.type)for(let t=0;t<o.preloadHints.length-1;t++){const n=o.preloadHints[t];n.type&&n.type===i.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${r} for segment #${e} has the same TYPE ${i.type} as preload hint #${t}`})}},"rendition-report"(){const e=p(t.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(e);const i=this.manifest.renditionReports.length-1,n=["LAST-MSN","URI"];c&&n.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${i}`,t.attributes,n)},"part-inf"(){this.manifest.partInf=p(t.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",t.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),g.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(p(t.attributes));const e=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${e}`,t.attributes,["ID","START-DATE"]);const i=this.manifest.dateRanges[e];i.endDate&&i.startDate&&new Date(i.endDate)<new Date(i.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),i.duration&&i.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),i.plannedDuration&&i.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const n=!!i.endOnNext;if(n&&!i.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),n&&(i.duration||i.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),i.duration&&i.endDate){const t=i.startDate.getTime()+1e3*i.duration;this.manifest.dateRanges[e].endDate=new Date(t)}if(E[i.id]){for(const t in E[i.id])if(i[t]&&JSON.stringify(E[i.id][t])!==JSON.stringify(i[t])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const t=this.manifest.dateRanges.findIndex((t=>t.id===i.id));this.manifest.dateRanges[t]=r(this.manifest.dateRanges[t],i),E[i.id]=r(E[i.id],i),this.manifest.dateRanges.pop()}else E[i.id]=i},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=p(t.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",t.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const e=(t,e)=>{t in this.manifest.definitions?this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${t}`}):this.manifest.definitions[t]=e};if("QUERYPARAM"in t.attributes){if("NAME"in t.attributes||"IMPORT"in t.attributes)return void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});const i=this.params.get(t.attributes.QUERYPARAM);return i?void e(t.attributes.QUERYPARAM,decodeURIComponent(i)):void this.trigger("error",{message:`EXT-X-DEFINE: No query param ${t.attributes.QUERYPARAM}`})}return"NAME"in t.attributes?"IMPORT"in t.attributes?void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"}):"VALUE"in t.attributes&&"string"==typeof t.attributes.VALUE?void e(t.attributes.NAME,t.attributes.VALUE):void this.trigger("error",{message:`EXT-X-DEFINE: No value for ${t.attributes.NAME}`}):"IMPORT"in t.attributes?this.mainDefinitions[t.attributes.IMPORT]?void e(t.attributes.IMPORT,this.mainDefinitions[t.attributes.IMPORT]):void this.trigger("error",{message:`EXT-X-DEFINE: No value ${t.attributes.IMPORT} to import, or IMPORT used on main playlist`}):void this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:t.attributes,uri:t.uri,timeline:f}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",t.attributes,["BANDWIDTH","URI"])}}[t.tagType]||l).call(e)},uri(){o.uri=t.uri,i.push(o),this.manifest.targetDuration&&!("duration"in o)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),s&&(o.key=s),o.timeline=f,n&&(o.map=n),b=0,null!==this.lastProgramDateTime&&(o.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=1e3*o.duration),o={}},comment(){},custom(){t.segment?(o.custom=o.custom||{},o.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(e)}))}requiredCompatibilityversion(t,e){(t<e||!t)&&this.trigger("warn",{message:`manifest must be at least version ${e}`})}warnOnMissingAttributes_(t,e,i){const n=[];i.forEach((function(t){e.hasOwnProperty(t)||n.push(t)})),n.length&&this.trigger("warn",{message:`${t} lacks required attribute(s): ${n.join(", ")}`})}push(t){this.lineStream.push(t)}end(){this.lineStream.push("\n"),this.manifest.dateRanges.length&&null===this.lastProgramDateTime&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(t){this.parseStream.addParser(t)}addTagMapper(t){this.parseStream.addTagMapper(t)}}}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i(794)})();